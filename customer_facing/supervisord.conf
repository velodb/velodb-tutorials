[supervisord]
nodaemon=true
logfile=/dev/stdout
logfile_maxbytes=0
pidfile=/var/run/supervisord.pid

[program:datagen]
command=python3 /app/datagen/datagen.py --host %(ENV_VELODB_HOST)s --port %(ENV_VELODB_PORT)s --user %(ENV_VELODB_USER)s --password "%(ENV_VELODB_PASSWORD)s" --database %(ENV_VELODB_DATABASE)s --events-per-second 5
autostart=true
autorestart=true
startsecs=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:evidence]
directory=/app/evidence
command=npm run dev -- --host 0.0.0.0 --port 3000
autostart=true
autorestart=true
startsecs=10
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:source-refresh]
directory=/app/evidence
command=/bin/bash -c "while true; do sleep 5; echo '[REFRESH] Updating Evidence data cache...'; npm run sources --yes 2>&1 | tail -5; done"
autostart=true
autorestart=true
startsecs=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
